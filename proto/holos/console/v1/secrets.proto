syntax = "proto3";

package holos.console.v1;

option go_package = "github.com/holos-run/holos-console/gen/holos/console/v1;consolev1";

// SecretsService provides access to Kubernetes secrets with RBAC.
service SecretsService {
  // ListSecrets returns secrets the user has access to in the current namespace.
  // Only returns secrets with the holos.run/console.holos.run label.
  // Filters results to secrets where the user is in allowed-groups.
  // Requires authentication via Authorization: Bearer <id_token> header.
  rpc ListSecrets(ListSecretsRequest) returns (ListSecretsResponse);

  // GetSecret retrieves a secret by name from the current namespace.
  // Requires authentication via Authorization: Bearer <id_token> header.
  // Returns PermissionDenied if user is not in the secret's allowed-groups.
  rpc GetSecret(GetSecretRequest) returns (GetSecretResponse);
}

// GetSecretRequest contains the name of the secret to retrieve.
message GetSecretRequest {
  // name is the name of the secret to retrieve.
  string name = 1;
}

// GetSecretResponse contains the secret data.
message GetSecretResponse {
  // data contains the secret key-value pairs.
  // Values are the raw secret bytes (not base64 encoded).
  map<string, bytes> data = 1;
}

// ListSecretsRequest contains optional filters for listing secrets.
message ListSecretsRequest {
  // Reserved for future filtering options.
}

// ListSecretsResponse contains the list of secrets the user can access.
message ListSecretsResponse {
  // secrets contains metadata about each accessible secret.
  repeated SecretMetadata secrets = 1;
}

// SecretMetadata contains non-sensitive information about a secret.
message SecretMetadata {
  // name is the name of the secret.
  string name = 1;
}
